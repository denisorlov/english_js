<!DOCTYPE html>
<html>
<head>
    <!--meta property="og:title" content="–†—É—Å—Å–∫–æ-–ê–Ω–≥–ª–∏–π—Å–∫–∏–π –†–∞–∑–≥–æ–≤–æ—Ä–Ω–∏–∫ –¢—Ä–µ–Ω–∞–∂–µ—Ä"/>
    <meta property="og:description" content="–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ '–†–∞–∑–≥–æ–≤–æ—Ä–Ω–∏–∫ - —Ç—Ä–µ–Ω–∞–∂–µ—Ä' –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è/–ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã—Ö —Ñ—Ä–∞–∑, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ–¥ –º–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞."/>
    <meta property="og:image" content=""/>
    <meta property="og:url" content= ""/-->

    <!--script type="text/javascript" src="http://yandex.st/jquery/1.6.1/jquery.min.js"></script-->
	
	<script type="text/javascript" src="playerMediaLib.js"></script>

	<!-- DICTIONARY -->
	<script type="text/javascript" src="dict71700.js"></script>
	<script type="text/javascript" src="trans.js"></script>
	<script type="text/javascript" src="utils.js"></script>
	<script type="text/javascript" src="interface.js"></script>
    <title></title>
	<style>
textarea{
	displays:none;
}
#lessonCombo{
	width: 100%;
	font-size: 20px;
}
#swMesure{
    border-radius: 3px;
}
.contentPanel{
    float: left;
    width: 63%; /*83*/
	margin: 0;
}
.butPanel{
    float: right;
    width: 35%; /*15*/
	margin: 0;
}	
.but{
	width: 45%; /*95*/
	padding: 15% 5%;
	text-align: center;
    margin: 2% 2% 2% 0;
    font-size: 20px;
	/*display: block;*/
	overflow: hidden;
	white-space: nowrap;
	border-radius: 20%;
	border: solid 1px gray;
}
#phraseOutput{
	font-size: 40px;
	float: left;
	width: 95%;
}
.blue{
	color: blue;
}
.green{
	color: green;
}
.gray{
	color: gray;
}
.transription{
	color: orange;
}
.toggler{
	width: 1em;
	font-size: 1em;
	font-weight: bold;
	border: solid 1px gray;
	border-radius: 1em;
	text-align: center;
}
.pointered{
	cursor: pointer;
}

#infoWrap, #objectPanel{
    display:none;
    border: 1px solid navy;
    width: 95%;
    height: 95%;
    z-index: 1000;
    background-color: rgba(255, 255, 255, 0.941176);
	color: black;
    padding: 2%;
    border-radius: 5px;
    box-sizing: border-box;
    position: fixed;
    right: 2%;;
    bottom: 2%;;
    left: 2%;
    font-size: 2em;
}
#infoPanel{
    float: right;
    width: 3.5em;
    overflow: auto;
    height: 100%;
}
.ipBut,.dcBut{
    font-weight: bold;
    font-size: 1.5em;
    margin-bottom: 2px;
}
.ipBut{
    float:right;
    font-size: 2em;
    width: 1.5em;
    height: 20%;
}
.closeBut{
	height: 1.5em;
	margin-bottom: .5em;
}
.infoContent{
    height: 100%;
    overflow: auto;
    display: none;
}
#infoSetting input,#infoSetting select{
    text-align: center;
    font-size: 100%;
    width: 20%;
    margin: 0.2em 0.2em 0 0;
}

#infoDictHead {
	cursor: pointer;
	border-bottom: 1px dashed;
	margin-bottom: 0;
}
.transcription{
	font-family: sans-serif;
	font-weight: bold;
	/*height: 49%;*/
	color:red;
}
.origin{
	/*height: 48%;*/
	color:blue;
	margin-top: 0.5%;
}
.origin a {
	text-decoration: none;
	border-bottom: 1px dashed;
}
.dcBut{
	font-size: 1em;
}

#media{
	height: 20px;
    width: 98%;
    position: fixed;
    top: 0;
}
.contentPanel,.butPanel{
	margin-top: 20px;
}	
#statusPanel{
    border: dashed 1px green;
    position: fixed;
    left: 0;
    bottom: 0;
    font-size: 1.5em;
    max-width: 100%;
    padding: 0.1em;
    background-color: aliceblue;
    border-radius: 0.2em;
}
	</style>
</head>
<body>
<!--	
	https://reallanguage.club/wp-content/uploads/2016/08/3_Corruption.mp3?_=1	
-->
<video id="media" controls name="media" src="https://d1qx7pbj0dvboc.cloudfront.net/hello.mp3"></video><!-- http://www.howjsay.com/mp3/hello.mp3 -->
<div class="contentPanel">
	<select id="lessonCombo"></select>
	<!--div id="swMesure" style="border: 1px solid green;box-sizing: border-box;position: relative;" title="">
		<div id="swmIndicator" style="background-color: green; text-align: center; color: white; width: 0%;"></div>
	</div-->
	
	<div id="editPanel" style="display: none">
		<input type="button" value="–ó–∞–≥—Ä—É–∑–∏—Ç—å..." onclick="loadForEdit()"/>
		<input type="button" value="–û—á–∏—Å—Ç–∏—Ç—å..." onclick="resetForEdit()"/>&nbsp;&nbsp;
		<select id="selTextEdit" style="width: 100px;">
			<option value="">–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç—ã...</option>
		</select>
		<input type="button" value="–ü–æ—Å—Ç—Ä–æ–∏—Ç—å..." onclick="buildTable()"/>
		<input type="button" value="–ó–∞–≤–µ—Ä–Ω—É—Ç—å..."  onclick="wrapToObj()"/>
		<a href="https://reallanguage.club/anglijskie-teksty-s-audio/" target=_blank>reallanguage</a>
		<a href="https://ouenglish.ru/english-story-audio" target=_blank>ouenglish</a>
		<a href="https://tophonetics.com/" target=_blank>tophonetics</a>
		<a href="http://englishfox.ru/" target=_blank>englishfox</a>
		<br/>
		—Å—Å—ã–ª–∫–∞ –Ω–∞ –º–µ–¥–∏–∞ <input type="text" id="inSrc" onchange="media.src=this.value"/>
		–Ω–∞–∑–≤–∞–Ω–∏–µ <input type="text" id="inTitle"/>
		—É—Ä–æ–≤–µ–Ω—å <select id="selLevel">
			<option value="">–Ω–µ –≤—ã–±—Ä–∞–Ω</option>
			<option value="A">A (–Ω–∞—á–∞–ª—å–Ω—ã–π)</option>
			<option value="B">B (—Å—Ä–µ–¥–Ω–∏–π)</option>
			<option value="C">C (–ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π)</option>
		</select>
		<input type="hidden" id="inPos" style="width: 98%;"/>
		<br/>
		<textarea id="taEn" style="height: 300px; width: 48%;"></textarea>
		<textarea id="taRu" style="height: 300px; width: 48%;"></textarea>
		<textarea id="taTr" style="height: 100px; width: 98%;"></textarea>
		<table id="posTable" border="1" style="font-size: 1.5em">
			<tbody style="vertical-align: baseline"></tbody>
		</table>
		<div id="objectPanel" style="display: none">
			<input type="button" value="Close" onclick="objectPanel.style.display='none'"/>
			<br/>
			<textarea id="taObj" style="height: 95%; width: 98%;background-color: black;color:antiquewhite;"></textarea>
		</div>
	</div>

	<div id="phraseOutput"></div>
</div>
<div class="butPanel">
	<select id="selLevelFilter" title="–§–∏–ª—å—Ç—Ä —É—Ä–æ–≤–Ω—è" style="font-size: 20px;width: 45%;margin-right: 2%;" onchange="filterByLevel(this.value)">
		<option value="">–≤—Å–µ</option>
		<option value="A">A</option>
		<option value="B">B</option>
		<option value="C">C </option>
	</select>
	<button id="buttonToggleEdit" title="–†–µ–¥–∞–∫—Ç–æ—Ä..." style="width: 45%; margin: 0 0 2% 0;" onclick="toggleEdit('editPanel')">&#9997;...</button>
	<br/>
	<button id="togglePlay" onclick="mTrainer.togglePlay()" class="but">‚ñ≤ Play</button>
	<button id="toStart" onclick="mTrainer.toStart()" class="but">‚ñº Rept</button>
	<button id="toPrev" onclick="mTrainer.toPrev()" class="but">‚óÑ Prev</button>
	<button id="toNext" onclick="mTrainer.toNext()" class="but">‚ñ∫ Next</button>
	<div title="toggle buttons..." onclick="toggleElem('hiddenBut', this)" class="toggler pointered">+</div>
	<div id="hiddenBut" style="display: none">
		<button onclick="mTrainer.splitPhrase(3)" class="but">3/12</button>
		<button onclick="mTrainer.splitPhrase(5)" class="but">5/12</button>
		<button onclick="mTrainer.splitPhrase(7)" class="but">7/12</button>
		<button onclick="mTrainer.splitPhrase(9)" class="but">9/12</button>
	</div>
	<button onclick="infoWrapToggle('infoSetting')" class="but">üîß Menu</button>
	<button id="toSlow" onclick="mTrainer.toSlow(this)" class="but">üïí Slow</button>
</div>

<div style="clear:both"></div>

<!-- statusPanel -->
<script type="text/javascript">
function showStatus(str, dur){
	dur = dur || Math.ceil(str.length/8)*1000;
	let el = document.getElementById('statusPanel');
	el.innerHTML = str;
	setTimeout( (function(_el, _str){ 
		return ()=>{ _el.innerHTML ==_str ? _el.innerHTML = '': 0;} 
	}(el, str)), dur);
}
</script>
<div id="statusPanel"></div>

<script type="text/javascript">
function infoWrapToggle(infoContentId){
	var i, elems = document.querySelectorAll('.infoContent');
	for(i=0;i<elems.length;i++){
		var infoContId = elems[i].id;
		document.getElementById(infoContId).style.display = infoContId===infoContentId ? 'block' : 'none'
	}

	document.getElementById('infoWrap').style.display = infoContentId ? 'block' : 'none';

}
function changeTheme(night){
	document.body.style.backgroundColor = night ? 'black' : 'white';
    document.body.style.color = night ? 'white' : 'black';
}

function toggleElem(id, handle){
	let el = document.getElementById(id);
	el.style.display = el.style.display == 'none' ? 'block' : 'none';

	if(handle){
		handle.innerHTML = el.style.display == 'block' ? '-' : '+';
	}
	return el.style.display == 'block'; // boolean
}
function resetForEdit(){
	if(taEn.value.length>1 && !confirm('–¢–æ—á–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä?')) return;

	resetPosTable();
	inSrc.value = '';
	media.src = '';
	
	inTitle.value = '';
	selLevel.value = '';
	
	taEn.value = '';
	taRu.value = '';
	taTr.value = '';
	inPos._value = null;
}
function loadForEdit(){
	let les = lessons[lessonCombo.value];
	if(!les){
		alert('–í—ã–±–µ—Ä–∏—Ç–µ —É—Ä–æ–∫ –∏–∑ —Å–ø–∏—Å–∫–∞...');
		return;
	}
	let cPosArr = getPosArrFromTable().filter(function(it){return it!==''});
	if(cPosArr.length>1 && !confirm('–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–º–µ–Ω–∏—Ç —Ç–∞–±–ª–∏—Ü—É —Å –ø–æ–∑–∏—Ü–∏—è–º–∏. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) return;
	
	resetPosTable();
	inSrc.value = les.src;
	media.src = les.src;
	
	inTitle.value = les.title;
	selLevel.value = les.lev;
	
	taEn.value = les.en;
	taRu.value = les.ru;
	taTr.value = les.tr || '';
	inPos._value = les.pos;
	
	buildTable();
}
function splitText(text){
	return text.replace(/\n/g, '').replace(/([\.!\?‚Ä¶]+)/g, '$1\n').trim().split('\n')
}
function buildTable(){
	let cPosArr = getPosArrFromTable().filter(function(it){return it!==''});
	if(cPosArr.length>0){
		inPos._value = cPosArr;
	}

	let enArr = splitText(taEn.value),
		ruArr = splitText(taRu.value),
		trArr = splitText(taTr.value),
		posArr = inPos._value;
	buildPosTable(enArr, ruArr, trArr, posArr);
}
function getPosArrFromTable(){
	let posArr = [];
	document.querySelectorAll("#posTable tbody tr").forEach(function(tr){
		posArr.push(tr.cells[0].innerHTML);
	});
	return posArr;
}
function wrapToObj(){
	let posArr = getPosArrFromTable(),
		resObj = {
			title: inTitle.value, 
			lev: selLevel.value, 
			src: inSrc.value, 
			pos: posArr, 
			en: taEn.value, 
			ru: taRu.value,
			tr: taTr.value
		},
		str = JSON.stringify(resObj, function(k, value){
			if(k=='pos') return undefined; // –º–∞—Å—Å–∏–≤ pos - –æ—Ç–¥–µ–ª—å–Ω–æ –∏–Ω–∞—á–µ –±—É–¥–µ—Ç –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–º
			return value;
		}, 2)
		.replace(/({)/, '$1\n  "pos": '+JSON.stringify(resObj.pos)+',');

	console.log(str);
	taObj.value = str;
	toggleElem('objectPanel');
}

function resetPosTable(){
	document.querySelectorAll("#posTable tbody tr").forEach(function(e){e.remove()});
}
function buildPosTable(enArr, ruArr, trArr, posArr){
	resetPosTable();

	enArr.forEach(function(item, i, arr){
		var newRow=posTable.insertRow();
		newRow.style.cursor = 'pointer';

		var cellPos = newRow.insertCell();
		cellPos.style.textAlign = 'center';
		cellPos.innerHTML= posArr && posArr[i] ? posArr[i] : '';
		cellPos.onclick = (function(cell){
			return ()=>{
				media.currentTime = cell.innerHTML;
				media.paused ? media.play() : 0;
			}
		}(cellPos));
		cellPos.width="50";

		var cellMin = newRow.insertCell();
		cellMin.innerHTML="‚óÑ";
		cellMin.onclick = (function(cell){
			return ()=>{
				cell.innerHTML = Math.max(0, parseFloat(cell.innerHTML)-0.5);
				media.currentTime = cell.innerHTML;
			}
		}(cellPos));
		var cellPls = newRow.insertCell();
		cellPls.innerHTML="‚ñ∫";
		cellPls.onclick = (function(cell){
			return ()=>{
				cell.innerHTML = Math.min(Math.floor(media.duration), parseFloat(cell.innerHTML)+0.5);
				media.currentTime = cell.innerHTML;
			}
		}(cellPos));


		var cellEn = newRow.insertCell(),
			cellRu = newRow.insertCell(),
			cellTr = newRow.insertCell();
		cellEn.innerHTML=item;
		cellRu.innerHTML=ruArr[i];
		cellTr.innerHTML=trArr[i] ? trArr[i] : '';

		cellEn.onclick = cellRu.onclick = (function(cell){
			return ()=>{
				cell.innerHTML = Math.floor(media.currentTime);
			}
		}(cellPos))
	});
}

// init selTextEdit
(function(){
	let selectId = 'selTextEdit',
		k, select = document.getElementById(selectId),
		opts = {
			'–ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ:': ()=>{
				document.querySelectorAll('#'+selectId+' option').forEach((it)=>{
					if(it.value!=='–ø—Ä–∏–º–µ–Ω–∏—Ç—å –≤—Å–µ:' && it._editFn instanceof Function) it._editFn();
				})
			},
			'—É–±—Ä–∞—Ç—å –ø—É—Å—Ç—ã–µ —Å—Ç—Ä–æ–∫–∏': ()=>{
				taEn.value = taEn.value.replace(/\n\s*\n/g, '\n\n');
				taRu.value = taRu.value.replace(/\n\s*\n/g, '\n\n');
			},
			'—É–±—Ä–∞—Ç—å —Ç–æ—á–∫—É –ø–æ—Å–ª–µ Mr, Mrs –∏ —Ç.–ø.': ()=>{ taEn.value = taEn.value
				// /(([^\u0400-\u04FF\w]|^)[\w\u0400-\u04FF]{1,3})\./g
				let reg = /((\s|^)[A-Z–ê-–Ø–Å][A-z–ê-—è–Å—ë]{0,2})\./g; /* /(Mrs?)\./g */
				taEn.value = taEn.value.replace(reg, '$1');
				taRu.value = taRu.value.replace(reg, '$1');
			},
			'–æ–±–º–µ–Ω—è—Ç—å –º–µ—Å—Ç–∞–º–∏ –∫–∞–≤—ã—á–∫–∏ –∏ .!?‚Ä¶': ()=>{
				taEn.value = taEn.value.replace(/([\.!\?‚Ä¶]+)(‚Äù|"|'|¬ª)/g, '$2$1');
				taRu.value = taRu.value.replace(/([\.!\?‚Ä¶]+)(‚Äù|"|'|¬ª)/g, '$2$1');
			}
		}
	;

	for(k in opts){
		let opt = new Option(k, k,  false, false);
		opt._editFn = opts[k];
		select.appendChild(opt);
	}

	select.onchange = function(e){
		if(this.selectedOptions[0] && this.selectedOptions[0]._editFn instanceof Function)
			this.selectedOptions[0]._editFn();
		this.value = ''; // –≤–µ—Ä–Ω—É—Ç—å –Ω–∞ –≤—ã–±–æ—Ä
	};
}());

</script>
<div  id="infoWrap" style="">
	<div id="infoPanel">
        <input class="ipBut closeBut" title="–ó–∞–∫—Ä—ã—Ç—å" type="button" value="&#215;" style="color: red;" onclick="infoWrapToggle();"/>
		<input class="ipBut" title="–°–ª–æ–≤–∞—Ä—å" type="button" value="&#9997;" style="" onclick="infoWrapToggle('infoDict')"/>
		<input class="ipBut" title="–ù–∞—Å—Ç—Ä–æ–π–∫–∏" type="button" value="üîß" style="" onclick="infoWrapToggle('infoSetting')">
		<input class="ipBut" title="–ü–æ–º–æ—â—å" type="button" value="üïÆ" style="" onclick="infoWrapToggle('infoHelp')">
        <!-- $('.ipBut').height(Math.floor(100/($('.ipBut').length+1))+'%')// –∞–≤—Ç–æ–ø–æ–¥–≥–æ–Ω –≤—ã—Å–æ—Ç—ã -->
    </div>
	<div class="infoContent" id="infoHelp" style=""><h3>&#9786; Help</h3><hr/>
		<p>
			–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ ....
		</p>

		–ö–Ω–æ–ø–∫–∏:
		<ul>
			<li>‚ñ≤ Play: –∑–∞–ø—É—Å–∫ –∏ –ø–∞—É–∑–∞ –ø–ª–µ–µ—Ä–∞, –∫–ª–∞–≤–∏—à–∞ ‚ñ≤</li>
			<li>‚ñº Rept: –ø–æ–≤—Ç–æ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ñ—Ä–∞–∑—É, –∫–ª–∞–≤–∏—à–∞ ‚ñº</li>
			<li>‚óÑ Prev: –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Ñ—Ä–∞–∑—É –Ω–∞–∑–∞–¥, –∫–ª–∞–≤–∏—à–∞ ‚óÑ</li>
			<li>‚ñ∫ Next: –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ —Ñ—Ä–∞–∑—É –≤–ø–µ—Ä–µ–¥, –∫–ª–∞–≤–∏—à–∞ ‚ñ∫</li>
			<li>üïí Slow/Norm: –∑–∞–º–µ–¥–ª–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å, –∫–ª–∞–≤–∏—à–∞ 0</li>
			<li>üîß Menu: –æ—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</li>
			<li>3/12 5/12 7/12 9/12: –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —á–∞—Å—Ç—å —Ñ—Ä–∞–∑—ã –Ω–∞—á–∏–Ω–∞—è —Å 3, 5, 7 –∏–ª–∏ 9 –¥–æ–ª–∏</li>
		</ul>

		–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:
		<ul>
			<li>- +: —É—Ä–æ–≤–µ–Ω—å –≥—Ä–æ–º–∫–æ—Å—Ç–∏ –ø–ª–µ–µ—Ä–∞</li>
			<li>1-9: –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ —á–∞—Å—Ç—å —Ñ—Ä–∞–∑—ã –Ω–∞—á–∏–Ω–∞—è —Å —Å 1 –ø–æ 9 –¥–æ–ª—é</li>
		</ul>

		<script type="text/javascript" src="pluso.js"></script>

	</div>
	<div class="infoContent" id="infoSetting" style=""><h3>‚ò≠ Settings</h3><hr/>
		<label><input type="checkbox" onclick="changeTheme(this.checked)"/> Night theme</label>
		<br/>
		<select id="selectVKeyBrd" onchange="media.preload = this.value">
			<option value="metadata">—á–∞—Å—Ç–∏—á–Ω–∞—è</option><option value="auto">–ø–æ–ª–Ω–∞—è —Å—Ä–∞–∑—É</option>
		</select> –ó–∞–≥—Ä—É–∑–∫–∞ –º–µ–¥–∏–∞ —Ñ–∞–π–ª–∞
	</div>
<!--
 let initAResult = dictFindSmart(word);
 treatHistoryNavigator(word);
 initInfoDictElements(initAResult);

 infoWrapToggle('infoDict');
-->
	<div class="infoContent" id="infoDict">
		<h2 onclick="if(res = prompt('–ù–∞–π—Ç–∏ –≤ c–ª–æ–≤–∞—Ä–µ:', this.innerHTML), res!='') showA(res);" id="infoDictHead" class="origin">dictionary</h2>
		<div>
			<input type="button" class="dcBut" id="dictPrevBut" disabled="disabled" value="&#8666;" onclick="showA(dh.previous(), true)">
			<input type="button" class="dcBut" style="float:right" id="dictNextBut" disabled="disabled" value="&#8667;" onclick="showA(dh.next(), true)">
		</div>
		<div id="infoDictTranscription" class="transcription"></div>
		<div id="infoDictContent">&#9997; –ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Å–ª–æ–≤–∞—Ä–Ω—ã–µ —Å—Ç–∞—Ç—å–∏. –©–µ–ª–∫–Ω–∏—Ç–µ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –Ω–∞–π—Ç–∏ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é —Å—Ç–∞—Ç—å—é.</div>
	</div>
</div>
<script type="text/javascript">
var mTrainer = new MediaTrainer(
	media,
	'phraseOutput',
	function(learned){ // setIndicatorFunction
		var swmIndicator = document.getElementById("swmIndicator");
		swmIndicator.style.width = swmIndicator.innerHTML = learned+'%';
		swmIndicator.parentNode.title = '–í—ã—É—á–µ–Ω–æ ' + learned+'%';
	}
);
media.addEventListener('timeupdate', function () {
    mTrainer.treatPosition(media.currentTime);
}, false);
//media.volume=0.7;
//media.preload = 'auto'; //–ó–∞–≥—Ä—É–∑–∏—Ç—å  —Ü–µ–ª–∏–∫–æ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

function MediaTrainer(
	mediaElem,
	phraseOutputId,
	setIndicatorFunction
){
	this.setIndicator = setIndicatorFunction || function(){};
	
	// private
	var _this = this,
		currentLessonId,
		currentLesson,
		currEn, currRu, currTr,
		prevStart = 0, nextStart = 0,
		currStart = 0, currentEnd = -1,
		currIndex = -1
	;

	this.resetLesson = function(){
		currentLessonId = null;
		currentLesson = null;
		currEn = null; currRu = null; currTr = null;

		prevStart = 0; nextStart = 0;
		currStart = 0; currEnd = -1;
		currIndex = -1;
		document.getElementById(phraseOutputId).innerHTML = '';
	}

	this.initAndStart = function(id){
		this.resetLesson();
		if(!lessons[id]) return;

		currentLessonId = id;
		currentLesson = lessons[id];
		mediaElem.src = lessons[id].src;
		currEn = splitText(currentLesson.en);
		currRu = splitText(currentLesson.ru);
		currTr = splitText(currentLesson.tr || '');
	}

	this.togglePlay = function(){
		mediaElem.paused ? mediaElem.play() : mediaElem.pause();
	};
	this.toStart = function(){
		mediaElem.currentTime = currStart;
		mediaElem.play();
	};
	this.toSlow = function(but){
		mediaElem.playbackRate = (mediaElem.playbackRate === 1 ? 0.7 : 1);
		but.innerHTML = 'üïí '+(mediaElem.playbackRate === 1 ? 'Slow' : 'Norm');
		showStatus('playback rate = '+mediaElem.playbackRate);
	};
	this.toPrev = function(){
		mediaElem.currentTime = prevStart;
	};
	this.toNext = function(){
		mediaElem.currentTime = nextStart;
	};
	this.splitPhrase = function(cnt){
		let curSt = parseFloat(currStart), 
			curEnd = parseFloat(currEnd),
			gain = ((curEnd-curSt)/12*(cnt+1));
		mediaElem.currentTime = curSt+gain;
	}
	
	var _initButtons = (function(){
		// @TODO
	}());
	
	this.treatPosition = function(position){
		if(!currentLesson) return;
		if(position == mediaElem.duration) return;
		if(position>=currStart && position < currEnd) return;
		
		let pos  = currentLesson.pos, i, end;
		for(i=0; i<pos.length; i++){
			end = i < pos.length-1 ? pos[i+1] : mediaElem.duration;
			if(position>=pos[i] && position < end){
				prevStart = i<1 ? pos[0] : pos[i-1];
				nextStart = i < pos.length-1 ? pos[i+1] : pos[i];
				currStart = pos[i];
				currEnd = end;
				currIndex = i;
				document.getElementById(phraseOutputId).innerHTML = dictUtils.wrapInClass(currEn[currIndex], dictUtils.WORD_CLASS)
				+'<div class="gray">'
					+currRu[currIndex]
					+'<br/><i>('+(i+1)+'/'+pos.length+', '+currStart+')</i>'
				+'</div>'
				+(currTr[currIndex] ? '<div class="transription">'+currTr[currIndex]+'</div>' : '')
				;
				dictUtils.initClass(dictUtils.WORD_CLASS);
				break;
			}
		}
	}
}

function toggleEdit(id){
	if(toggleElem(id)){
		mTrainer.resetLesson();
		document.getElementById('lessonCombo').value = -1; // –≤—ã–±—Ä–∞—Ç—å...
	}
}

lessons = lessons || [];
lessons.push({
	"pos": ["3","10","14","21","28","34","42","49","54","63","68.5","77","83.5","89","102","105.5","109","115","119","123","129.5","135","141","143","148.5","151.5","156.5"],
	"title": "Corruption ",
	"lev": "B",
	"src": "https://reallanguage.club/wp-content/uploads/2016/08/3_Corruption.mp3?_=1",
	"en": "When an official of a government or business is acting dishonestly, we say that this person is corrupt. Corruption is a serious problem in many countries around the world. There are several different kinds of corrupt practices, including bribes, kickbacks, nepotism, and embezzlement.\n\nA bribe is a payment of money or some other benefit, in exchange for a decision that would not otherwise be made. For example, an accused criminal might bribe a judge so that the judge would make a decision of ‚Äúnot guilty.‚Äù Another example is that a business owner might bribe a government official so that the official would allow the construction of very unsafe buildings.\n\nA kickback is similar to a bribe, except that the official receives some part of the money in a dishonest business deal. For example, governments sometimes decide which company should build a road. A company might offer money to the government official who makes the decision, so that this company will be chosen, even if it is not the best company for the job.\n\nNepotism happens when an official unfairly gives advantages to his or her relatives. For example, a government official might hire a brother or sister to do a job even though other people would be much better qualified for the job. Of course, all of us want to help our relatives, but it is wrong to do this at the expense of the public.\n\nEmbezzlement happens when an official secretly steals some money from a company or government. For example, a manager at a company might secretly move some of the company‚Äôs money to his or her own bank account, or that manager might lie about his or her expenses in order to receive more payment from the company.\n\n \n\nCorruption has very bad effects on people, in several ways. Sometimes it can lead to very dangerous situations. One example of this is when unsafe construction projects are approved by officials who have been bribed. Another example is when criminals are freed as a result of bribes. Also, a country‚Äôs economy can be damaged by corruption. For example, if companies must pay bribes in order to do business, then they may decide to leave the country. Also, if people‚Äôs tax money is stolen by corrupt officials, this makes the people poorer. In addition, when company officials are corrupt, it makes the company less able to compete with other companies.\n\nHow can corruption be stopped? An important step is for each person to decide not to act in ways that are corrupt. People must agree to take this problem seriously. Also, each company and each government must have strict rules about corruption. It must be very clear to all employees-from the lowest to the highest-that corruption is totally unacceptable.",
	"ru": "–ö–æ–≥–¥–∞ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–µ–Ω–Ω—ã–π —á–∏–Ω–æ–≤–Ω–∏–∫ –∏–ª–∏ —Å–ª—É–∂–∞—â–∏–π –¥–µ–ª–æ–≤–æ–≥–æ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏—è –¥–µ–π—Å—Ç–≤—É–µ—Ç –Ω–µ—á–µ—Å—Ç–Ω–æ, –º—ã –≥–æ–≤–æ—Ä–∏–º, —á—Ç–æ —ç—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫ –∫–æ—Ä—Ä—É–º–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–π. –ö–æ—Ä—Ä—É–ø—Ü–∏—è —è–≤–ª—è–µ—Ç—Å—è —Å–µ—Ä—å–µ–∑–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π –≤–æ –º–Ω–æ–≥–∏—Ö —Å—Ç—Ä–∞–Ω–∞—Ö –º–∏—Ä–∞. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤–∏–¥–æ–≤ –∫–æ—Ä—Ä—É–ø—Ü–∏–æ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏, –≤–∫–ª—é—á–∞—è –≤–∑—è—Ç–∫–∏, –æ—Ç–∫–∞—Ç—ã, –∫—É–º–æ–≤—Å—Ç–≤–æ –∏ –∫–∞–∑–Ω–æ–∫—Ä–∞–¥—Å—Ç–≤–æ.\n\n–í–∑—è—Ç–∫–∞ ‚Äî —ç—Ç–æ –≤—ã–ø–ª–∞—Ç–∞ –¥–µ–Ω–µ–≥ –∏–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∫–æ–π-–ª–∏–±–æ –¥—Ä—É–≥–æ–π –≤—ã–≥–æ–¥—ã –≤ –æ–±–º–µ–Ω –Ω–∞ —Ä–µ—à–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–µ –±—ã–ª–æ –±—ã –ø—Ä–∏–Ω—è—Ç–æ. –ù–∞–ø—Ä–∏–º–µ—Ä, –æ–±–≤–∏–Ω—è–µ–º—ã–π –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫ –º–æ–∂–µ—Ç –ø–æ–¥–∫—É–ø–∏—Ç—å —Å—É–¥—å—é, —Å —Ç–µ–º —á—Ç–æ–±—ã —Å—É–¥—å—è –ø—Ä–∏–Ω—è–ª –≤–µ—Ä–¥–∏–∫—Ç ‚Äú–Ω–µ –≤–∏–Ω–æ–≤–µ–Ω¬ª.‚Äù –î—Ä—É–≥–æ–π –ø—Ä–∏–º–µ—Ä ‚Äî –≤–ª–∞–¥–µ–ª–µ—Ü –±–∏–∑–Ω–µ—Å–∞ –º–æ–∂–µ—Ç –ø–æ–¥–∫—É–ø–∏—Ç—å —á–∏–Ω–æ–≤–Ω–∏–∫–∞, —á—Ç–æ–±—ã —Ç–æ—Ç —Ä–∞–∑—Ä–µ—à–∏–ª —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –æ—á–µ–Ω—å –Ω–µ–Ω–∞–¥–µ–∂–Ω—ã—Ö –∑–¥–∞–Ω–∏–π.\n\n–û—Ç–∫–∞—Ç –ø–æ—Ö–æ–∂ –Ω–∞ –≤–∑—è—Ç–∫—É, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ —á–∏–Ω–æ–≤–Ω–∏–∫ –ø–æ–ª—É—á–∞–µ—Ç —á–∞—Å—Ç—å –¥–µ–Ω–µ–≥ –≤ –Ω–µ—á–µ—Å—Ç–Ω–æ–π —Å–¥–µ–ª–∫–µ. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∏–Ω–æ–≥–¥–∞ —Ä–µ—à–∞–µ—Ç, –∫–∞–∫–∞—è –∫–æ–º–ø–∞–Ω–∏—è –¥–æ–ª–∂–Ω–∞ —Å—Ç—Ä–æ–∏—Ç—å –¥–æ—Ä–æ–≥—É. –ö–æ–º–ø–∞–Ω–∏—è –º–æ–∂–µ—Ç –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥–µ–Ω—å–≥–∏ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–µ–Ω–Ω–æ–º—É —á–∏–Ω–æ–≤–Ω–∏–∫—É, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ, —á—Ç–æ–±—ã —ç—Ç–∞ –∫–æ–º–ø–∞–Ω–∏—è –±—ã–ª–∞ –≤—ã–±—Ä–∞–Ω–∞, –¥–∞–∂–µ –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –ª—É—á—à–∞—è –∫–æ–º–ø–∞–Ω–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã.\n\n \n\n–ö—É–º–æ–≤—Å—Ç–≤–æ ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —á–∏–Ω–æ–≤–Ω–∏–∫ –Ω–µ–æ–ø—Ä–∞–≤–¥–∞–Ω–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ —Å–≤–æ–∏–º —Ä–æ–¥—Å—Ç–≤–µ–Ω–Ω–∏–∫–∞–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–µ–Ω–Ω—ã–π —á–∏–Ω–æ–≤–Ω–∏–∫ –º–æ–∂–µ—Ç –Ω–∞–Ω—è—Ç—å –±—Ä–∞—Ç–∞ –∏–ª–∏ —Å–µ—Å—Ç—Ä—É –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã, –¥–∞–∂–µ –µ—Å–ª–∏ –¥—Ä—É–≥–∏–µ –ª—é–¥–∏ –±—É–¥—É—Ç –≥–æ—Ä–∞–∑–¥–æ –ª—É—á—à–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –¥–ª—è —ç—Ç–æ–π —Ä–∞–±–æ—Ç—ã. –ö–æ–Ω–µ—á–Ω–æ, –≤—Å–µ –º—ã —Ö–æ—Ç–∏–º –ø–æ–º–æ—á—å —Å–≤–æ–∏–º –±–ª–∏–∑–∫–∏–º, –Ω–æ –¥–µ–ª–∞—Ç—å —ç—Ç–æ –∑–∞ —Å—á–µ—Ç –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.\n\n–ö–∞–∑–Ω–æ–∫—Ä–∞–¥—Å—Ç–≤–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ —á–∏–Ω–æ–≤–Ω–∏–∫ —Ç–∞–π–Ω–æ –∫—Ä–∞–¥–µ—Ç –¥–µ–Ω—å–≥–∏ —É –∫–æ–º–ø–∞–Ω–∏–∏ –∏–ª–∏ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –º–µ–Ω–µ–¥–∂–µ—Ä –≤ –∫–æ–º–ø–∞–Ω–∏–∏ –º–æ–∂–µ—Ç —Ç–∞–π–Ω–æ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —á–∞—Å—Ç—å –¥–µ–Ω–µ–≥ –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–∞ —Å–≤–æ–π –±–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å—á–µ—Ç –∏–ª–∏ —ç—Ç–æ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä –º–æ–∂–µ—Ç —Å–æ–ª–≥–∞—Ç—å –æ —Å–≤–æ–∏—Ö —Ä–∞—Å—Ö–æ–¥–∞—Ö, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ –ø–ª–∞—Ç–µ–∂–µ–π –æ—Ç –∫–æ–º–ø–∞–Ω–∏–∏.\n\n–ö–æ—Ä—Ä—É–ø—Ü–∏—è –æ—á–µ–Ω—å –ø–ª–æ—Ö–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –ª—é–¥–µ–π, –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∞—Å–ø–µ–∫—Ç–∞—Ö. –ò–Ω–æ–≥–¥–∞ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—á–µ–Ω—å –æ–ø–∞—Å–Ω—ã–º —Å–∏—Ç—É–∞—Ü–∏—è–º. –û–¥–Ω–∏–º –∏–∑ –ø—Ä–∏–º–µ—Ä–æ–≤ —ç—Ç–æ–≥–æ —è–≤–ª—è–µ—Ç—Å—è —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–µ–Ω–∞–¥–µ–∂–Ω—ã—Ö —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –¥–æ–ª–∂–Ω–æ—Å—Ç–Ω—ã–º–∏ –ª–∏—Ü–∞–º–∏, –ø–æ–ª—É—á–∏–≤—à–∏–º–∏ –≤–∑—è—Ç–∫–∏. –î—Ä—É–≥–æ–π –ø—Ä–∏–º–µ—Ä ‚Äî –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –ø—Ä–µ—Å—Ç—É–ø–Ω–∏–∫–æ–≤ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∑—è—Ç–æ–∫. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –∫–æ—Ä—Ä—É–ø—Ü–∏—è –º–æ–∂–µ—Ç –Ω–∞–Ω–µ—Å—Ç–∏ —É—â–µ—Ä–± —ç–∫–æ–Ω–æ–º–∏–∫–µ —Å—Ç—Ä–∞–Ω—ã. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –∫–æ–º–ø–∞–Ω–∏–∏ –≤—ã–Ω—É–∂–¥–µ–Ω—ã –¥–∞–≤–∞—Ç—å –≤–∑—è—Ç–∫–∏, —á—Ç–æ–±—ã –≤–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å, –æ–Ω–∏ –º–æ–≥—É—Ç –ø—Ä–∏–Ω—è—Ç—å —Ä–µ—à–µ–Ω–∏–µ –ø–æ–∫–∏–Ω—É—Ç—å —Å—Ç—Ä–∞–Ω—É. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å–ª–∏ –Ω–∞—Ä–æ–¥–Ω—ã–µ –Ω–∞–ª–æ–≥–æ–≤—ã–µ –¥–µ–Ω—å–≥–∏ —É–∫—Ä–∞–¥–µ–Ω—ã –∫–æ—Ä—Ä—É–º–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —á–∏–Ω–æ–≤–Ω–∏–∫–∞–º–∏, —ç—Ç–æ –æ–±–µ–¥–Ω—è–µ—Ç –ª—é–¥–µ–π. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –∫–æ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ—Å—Ç–Ω—ã–µ –ª–∏—Ü–∞ –∫–æ–º–ø–∞–Ω–∏–∏ –∫–æ—Ä—Ä—É–º–ø–∏—Ä–æ–≤–∞–Ω—ã, —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–º–ø–∞–Ω–∏—é –º–µ–Ω–µ–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ–π.\n\n–ö–∞–∫ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ—Ä—Ä—É–ø—Ü–∏—é? –í–∞–∂–Ω—ã–º —à–∞–≥–æ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ —è–≤–ª—è–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ –Ω–µ –¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å –∫–æ—Ä—Ä—É–º–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–ø–æ—Å–æ–±–∞–º–∏. –õ—é–¥–∏ –¥–æ–ª–∂–Ω—ã —Å–æ–≥–ª–∞—Å–∏—Ç—å—Å—è —Å–µ—Ä—å–µ–∑–Ω–æ –æ—Ç–Ω–µ—Å—Ç–∏—Å—å –∫ —ç—Ç–æ–π –ø—Ä–æ–±–ª–µ–º–µ. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –∫–∞–∂–¥–∞—è –∫–æ–º–ø–∞–Ω–∏—è –∏ –∫–∞–∂–¥–æ–µ –ø—Ä–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ –¥–æ–ª–∂–Ω–æ –∏–º–µ—Ç—å —Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä—Ä—É–ø—Ü–∏–∏. –í—Å–µ–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º-–æ—Ç —Å–∞–º—ã—Ö –Ω–∏–∑–∫–∏—Ö –¥–æ–ª–∂–Ω–æ—Å—Ç–µ–π –¥–æ —Å–∞–º—ã—Ö –≤—ã—Å–æ–∫–∏—Ö, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–æ–≤–µ—Ä—à–µ–Ω–Ω–æ —è—Å–Ω–æ, —á—Ç–æ –∫–æ—Ä—Ä—É–ø—Ü–∏—è –∞–±—Å–æ–ª—é—Ç–Ω–æ –Ω–µ–ø—Ä–∏–µ–º–ª–µ–º–∞."
});

// initLessonCombo
initLessonCombo();
document.getElementById('lessonCombo').onchange = function(e){
	mTrainer.initAndStart(this.value);
};
document.getElementById('lessonCombo').onchange();

function filterByLevel(lev){
	let options = document.querySelectorAll("#lessonCombo option");
	options.forEach(function(op){
		op.style.display = 'inherit';
	});
	if(lev!=='')
		options.forEach(function(op){
			op.style.display = op.getAttribute('data-level')===lev? 'inherit' : 'none';
		})
}
// initKeydown
(function(){
	document.onkeydown = function(event){
		var id, key = event.keyCode;
		//console.log(key);
		if(key===109){ // -
			media.volume = Math.max(0, media.volume-0.1);
			showStatus('volume = '+media.volume.toFixed(1));
			return;
		}
		if(key===107){ // +
			media.volume = Math.min(1, media.volume+0.1);
			showStatus('volume = '+media.volume.toFixed(1));
			return;
		}
		if(key>=97 && key<=105){ // 1,2,3,4,5,6,7,8,9
			mTrainer.splitPhrase(key-96);
			return;
		}
		switch(key) {
		  case 37: // <-
			id = 'toPrev';
			break;
		  case 38:
		  	id = 'togglePlay';
			break;
		  case 39: // ->
			id = 'toNext';
			break;
		  case 40:
			id = 'toStart';
			break;
		  case 96: // 0
		  	id = 'toSlow';
		  	break;
		}
		let el = document.getElementById(id);
		if(el) el.click();
	}
}())


// document.onkeydown = function(event){
// 	var med = $('audio')[1], key = event.keyCode;
// 	if(key===37){  // <-
// 		med.currentTime-=2;
// 		event.preventDefault();
// 		return;
// 	}
// 	if(key===39){ // ->
// 		med.currentTime+=2;
// 		event.preventDefault();
// 		return;
// 	}
// }

</script>
<!-- DICTIONARY -->
<style>
	span.word {
		border-bottom: 1px dashed;
		cursor: pointer;
	}
</style>
<script type="text/javascript">
	// DICTIONARY Utils
	dictUtils = {
		WORD_CLASS: "word",
		checkFoo: function(){
			return window.dictFind instanceof Function
				&& window.dictFindSmart instanceof Function;
		},
		hint: function (el){
			var w=dictFind(dictSmall, el.innerHTML);
			if(w!=null) el.title = w.fw+': '+w.a;
		},
		openDictWin: function(word, top, left, width,height){
			var newWin = window.open(
					"dict.html#"+encodeURIComponent(word),
					"DictWin",
					"top="+(top||0)+",left="+(left||document.body.offsetWidth)+
					",width="+(width||420)+",height="+(height||500)+
					",resizable=yes,scrollbars=yes"
			);
			newWin.focus();
		},
		wrapInClass: function(en, className){
			if(!dictUtils.checkFoo()) return en;

			let w = en.split(/\b/ig);
			for(let i=0;i<w.length;i++){
				if(/^[a-z'-]+$/i.test(w[i])){
					w[i] = '<span class="'+className+'">'+w[i]+'</span>';//
				}
			}
			return w.join('');
		},
		initClass: function(className){
			if(!dictUtils.checkFoo()) return;

			let ind, ws = document.getElementsByClassName(className);
			for(ind in ws){
				let el = ws[ind];
				el.onmouseover = (function(this_){ return function(){
					dictUtils.hint(this_);
				}}(el));
				el.onclick = (function(this_){ return function(){
					let word = this_.innerHTML.toLowerCase(),
							initAResult = dictFindSmart(word);
					if(initAResult==null) return;
					dictUtils.openDictWin(initAResult.word);
				}}(el));
			}
		}
	};
</script>
</body>
</html>